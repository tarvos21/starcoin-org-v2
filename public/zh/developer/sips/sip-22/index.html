<!doctype html><html lang=zh><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name=viewport><meta id=i18n_pagename content="index-common"><link rel=icon type=image/svg href=/img/stc.svg><link rel=stylesheet type=text/css href=/css/bootstrap.css><link rel=stylesheet href=/css/swiper-bundle.css><link rel=stylesheet type=text/css href=/css/nav.css><link rel=stylesheet type=text/css href=/css/nav_developer.css><link rel=stylesheet type=text/css href=/css/banner.css><link rel=stylesheet type=text/css href=/css/font_zh.css><link rel=stylesheet type=text/css href=/css/footer.css><link rel=stylesheet type=text/css href=/css/developer.css><link rel=stylesheet type=text/css href=/css/markdown.css><script src=/js/jquery.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/swiper-bundle.min.js></script><script>(function(c,d){const b=196;function a(){const a=document.documentElement.clientWidth/1920,c=b*Math.min(a,2);document.documentElement.style.fontSize=c+'px'}a(),addEventListener('resize',a,!1)})(document,window)</script><script>$(document).ready(function(){a(),$(window).resize(function(){a()}),$(function(){$('.footer [data-toggle="tooltip"]').tooltip({})});function a(){}$("#developer_open_move").click(function(){$(this).parent().attr("class").indexOf("active")>-1?($(this).find(".icon img").attr("src","/img/icon_block.png"),$(this).parent().removeClass("active")):($(this).find(".icon img").attr("src","/img/icon_block_active.png"),$(this).parent().addClass("active"))})})</script><title>[SIP22] NFT | Starcoin</title></head><body><div class=hidden-xs><div class=header_top></div><div class="top scrollTop-nav"><div class=top-container><a href=/zh><img class=logo src=/img/logo.png></a><div class=top-right><div class="nav navClick"><div class="item Overview allSelect"><span class=i18n href=/zh/>首页</span><div class=more_nav><div class=box><div class=li><a class=i18n href=/downloads/Starcoin_zh.pdf target=_blank>Starcoin
& Move</a></div><div class=li><a class=i18n href=/zh/overview/technology_whitepaper/>技术白皮书</a></div><div class=li><a class=i18n href=/zh/overview/economy_whitepaper/>经济模型白皮书</a></div></div></div></div><div class="item Guide allSelect"><span class=i18n>使用指南</span><div class=more_nav><div class=box><div class=li><a class=i18n href=https://github.com/starcoinorg/starmask-extension/blob/main/docs/how-to-use.md target=_blank>StarMask浏览器钱包</a></div><div class=li><a class=i18n href=/zh/developer/cli/mint/>节点挖矿</a></div><div class=li><a class=i18n href=/zh/developer/cli/>节点命令</a></div></div></div></div><div class="item Developer allSelect"><span class=i18n>开发者</span><div class=more_nav><div class=box><div class=li><span class=i18n>开始</span><div class=second_nav><div class=li><a class=i18n href=/zh/developer/setup/install target=_blank>安装</a></div><div class=li><a class=i18n href=/zh/developer/setup/build target=_blank>从源码编译</a></div><div class=li><a class=i18n href=/zh/developer/setup/run_by_docker target=_blank>从 Docker 运行</a></div><div class=li><a class=i18n href=/zh/developer/setup/runnetwork target=_blank>运行和加入网络</a></div></div></div><div class=li><span class=i18n>节点</span><div class=second_nav><div class=li><a class=i18n href=/zh/developer/key_concepts/concept>关键概念</a></div><div class=li><a class=i18n href=/zh/developer/rpc/rpc_document/>RPC 协议</a></div><div class=li><a class=i18n href=/zh/developer/sips/>SIPs</a></div><div class=li><a class=i18n href=/zh/developer/sdk/>SDK</a></div></div></div><div class=li><span class=i18n>Move</span><div class=second_nav><div class=li><a class=i18n href=https://move-book.com/cn/index.html target=_blank>Move 开发指南</a></div><div class=li><a class=i18n href=https://github.com/starcoinorg/starcoin/blob/master/vm/move-cli/README.md target=_blank>Move IDE</a></div><div class=li><a class=i18n href=https://github.com/starcoinorg/starcoin/blob/master/vm/move-cli/README.zh.md target=_blank>Move CLI</a></div><div class=li><a class=i18n href=/zh/developer/move/example>Move 合约示例</a></div></div></div><div class=li><span class=i18n>矿池接入</span><div class=second_nav><div class=li><a class=i18n href=https://github.com/starcoinorg/starcoin/discussions/2541 target=_blank>矿池接入</a></div><div class=li><a class=i18n href=https://github.com/starcoinorg/starcoin/blob/b47429fc792fe9fabd1587fa60a9cae249f0b67f/stratum/stratum_mining_protocol.md target=_blank>矿池协议</a></div></div></div><div class=li><a class=i18n href=/zh/developer/>更多</a></div></div></div></div><div class="item Community allSelect"><span class=i18n>社区</span><div class=more_nav><div class=box><div class=li><a class=i18n href=/zh/news/>新闻</a></div><div class=li><a class=i18n href=https://westar.io target=_blank>Westar 实验室</a></div><div class=li><a class=i18n href=https://www.movelang.io target=_blank>Move 中文社区</a></div><div class=li><a class=i18n href=https://stcscan.io target=_blank>Starcoin 浏览器</a></div><div class=li><a class=i18n href=https://poll.starcoin.org target=_blank>Starcoin 投票</a></div></div></div></div><div class="item About allSelect"><a class=i18n href=/zh/about><span class=i18n>关于</span></a></div><div class="item Language allSelect hidden-xs"><div class=language-box><span class=i18n><img src=/img/icon_zh.png alt>zh</span></div><div class=more_nav><div class=box><div class="li nav-language"><div language=zh class=item><img src=/img/icon_zh.png alt>
中文</div></div><div class="li nav-language"><div language=en class=item><img src=/img/icon_en.png alt>
English</div></div></div></div></div><script>$(document).ready(function(){$(".nav-language .item").click(function(){let a=window.location.href,b=$(this).attr('language'),c="zh";c!==b&&(a=a.replace(`/${c}/`,`/${b}/`),window.location.href=a)})})</script></div></div></div></div></div><div class=visible-xs style=display:block><div class="header_top m_header_top"></div><div class="top m_top scrollTop-nav"><div class="container m_container"><a href=/><div class=m_logo><img src=/img/logo.png></div></a><div class="m_nav m_nav_tap"><img src=/img/m_nav_more.png></div></div></div><div class=m_nav_model><div class="nav navClick m_nav_navigation"><div class="item Overview allSelect"><span class=i18n href=/zh/>首页</span><div class=more_nav><div class=box><div class=li><a class=i18n href=/downloads/Starcoin_zh.pdf target=_blank>Starcoin
& Move</a></div><div class=li><a class=i18n href=/zh/overview/technology_whitepaper/>技术白皮书</a></div><div class=li><a class=i18n href=/zh/overview/economy_whitepaper/>经济模型白皮书</a></div></div></div></div><div class="item Guide allSelect"><span class=i18n>使用指南</span><div class=more_nav><div class=box><div class=li><a class=i18n href=https://github.com/starcoinorg/starmask-extension/blob/main/docs/how-to-use.md target=_blank>StarMask浏览器钱包</a></div><div class=li><a class=i18n href=/zh/developer/cli/mint/>节点挖矿</a></div><div class=li><a class=i18n href=/zh/developer/cli/>节点命令</a></div></div></div></div><div class="item Developer allSelect"><span class=i18n>开发者</span><div class=more_nav><div class=box><div class=li><span class=i18n>开始</span><div class=second_nav><div class=li><a class=i18n href=/zh/developer/setup/install target=_blank>安装</a></div><div class=li><a class=i18n href=/zh/developer/setup/build target=_blank>从源码编译</a></div><div class=li><a class=i18n href=/zh/developer/setup/run_by_docker target=_blank>从 Docker 运行</a></div><div class=li><a class=i18n href=/zh/developer/setup/runnetwork target=_blank>运行和加入网络</a></div></div></div><div class=li><span class=i18n>节点</span><div class=second_nav><div class=li><a class=i18n href=/zh/developer/key_concepts/concept>关键概念</a></div><div class=li><a class=i18n href=/zh/developer/rpc/rpc_document/>RPC 协议</a></div><div class=li><a class=i18n href=/zh/developer/sips/>SIPs</a></div><div class=li><a class=i18n href=/zh/developer/sdk/>SDK</a></div></div></div><div class=li><span class=i18n>Move</span><div class=second_nav><div class=li><a class=i18n href=https://move-book.com/cn/index.html target=_blank>Move 开发指南</a></div><div class=li><a class=i18n href=https://github.com/starcoinorg/starcoin/blob/master/vm/move-cli/README.md target=_blank>Move IDE</a></div><div class=li><a class=i18n href=https://github.com/starcoinorg/starcoin/blob/master/vm/move-cli/README.zh.md target=_blank>Move CLI</a></div><div class=li><a class=i18n href=/zh/developer/move/example>Move 合约示例</a></div></div></div><div class=li><span class=i18n>矿池接入</span><div class=second_nav><div class=li><a class=i18n href=https://github.com/starcoinorg/starcoin/discussions/2541 target=_blank>矿池接入</a></div><div class=li><a class=i18n href=https://github.com/starcoinorg/starcoin/blob/b47429fc792fe9fabd1587fa60a9cae249f0b67f/stratum/stratum_mining_protocol.md target=_blank>矿池协议</a></div></div></div><div class=li><a class=i18n href=/zh/developer/>更多</a></div></div></div></div><div class="item Community allSelect"><span class=i18n>社区</span><div class=more_nav><div class=box><div class=li><a class=i18n href=/zh/news/>新闻</a></div><div class=li><a class=i18n href=https://westar.io target=_blank>Westar 实验室</a></div><div class=li><a class=i18n href=https://www.movelang.io target=_blank>Move 中文社区</a></div><div class=li><a class=i18n href=https://stcscan.io target=_blank>Starcoin 浏览器</a></div><div class=li><a class=i18n href=https://poll.starcoin.org target=_blank>Starcoin 投票</a></div></div></div></div><div class="item About allSelect"><a class=i18n href=/zh/about><span class=i18n>关于</span></a></div><div class="item Language allSelect hidden-xs"><div class=language-box><span class=i18n><img src=/img/icon_zh.png alt>zh</span></div><div class=more_nav><div class=box><div class="li nav-language"><div language=zh class=item><img src=/img/icon_zh.png alt>
中文</div></div><div class="li nav-language"><div language=en class=item><img src=/img/icon_en.png alt>
English</div></div></div></div></div><script>$(document).ready(function(){$(".nav-language .item").click(function(){let a=window.location.href,b=$(this).attr('language'),c="zh";c!==b&&(a=a.replace(`/${c}/`,`/${b}/`),window.location.href=a)})})</script></div><div class=m-language><div language=zh class=item>中文<div class=line></div></div><div language=en class=item>English</div></div></div><div class=clearfix></div></div><script>$(document).ready(function(){const a=JSON.parse(localStorage.getItem('navActive'))||0;$(".navClick .item")[a].classList.add('navActive'),$(".p-language span, .m-language .item").click(function(){let a=window.location.href,b=$(this).attr('language'),c="zh";c!==b&&(a=a.replace(`/${c}/`,`/${b}/`),window.location.href=a)}),$(".navClick .item").click(function(){let b=$(this)[0]||null;if(b){b.classList.add('navActive');let e=[],d=b.parentNode.children;for(var a=0,c=d.length;a<c;a++)d[a]!==b?e.push(d[a]):localStorage.setItem('navActive',a);e.forEach(a=>{a.classList.remove('navActive')})}$(this).attr("href")&&window.open($(this).attr("href"),"_self")}),$(".more_nav .box .li").click(function(){$(this).attr("href")&&window.open($(this).attr("href"),"_self")}),$(".m_nav_navigation").find(".allSelect").click(function(){$(this).attr("class").indexOf("m_tab_select")>-1?(console.log($(this)),$(this).removeClass("m_tab_select")):$(this).addClass("m_tab_select")}),$(".m_nav_tap").click(function(){$(this).find("img").attr("src")=="/img/m_nav_more.png"?($(this).find("img").attr("src","/img/m_nav_close.png"),$(".m_nav_model").show(),$(".m_nav_model").animate({height:"100%"}),$(".scrollTop-nav").addClass("home-nav")):($(this).find("img").attr("src","/img/m_nav_more.png"),$(".scrollTop-nav").removeClass("home-nav"),$(".m_nav_model").animate({height:"0%"}),$(".m_nav_model").hide())})})</script><div class=container><div class="developer m-column-drawer"><div class=developer_left><div class=developer_column><img class=dev_logo src=/img/dev_logo.png></div><div class=developer_column_list><ul><li><a href=/zh/developer/setup/ class=arrow>从这里开始</a></li><li><a href=/zh/developer/cli/ class=arrow>命令行工具</a></li><li><a href=/zh/developer/tutorials/ class=arrow>教程</a></li><li><a href=/zh/developer/move/ class=arrow>Move 语言</a></li><li><a href=/zh/developer/key_concepts/ class=arrow>关键概念</a></li><li><a href=/zh/developer/rpc/ class=arrow>RPC</a></li><li><a href=/zh/developer/release-notes/ class=arrow>版本记录</a></li><li><a href=/zh/developer/sdk/>SDK</a><ul></ul></li><li><a href=/zh/developer/account/ class=arrow>Starcoin账户说明</a></li><li><a href=/zh/developer/sips/sip-22/ class=active>[SIP22] NFT</a></li><li><a href=/zh/developer/tech/ class=arrow>技术</a></li><li><a href=/zh/developer/protocols/starcoin_nft/>NFT 协议</a></li></ul></div></div><div class=developer_right><div class=m_mask></div><div class="visible-lg column_title"><span>[SIP22] NFT</span></div><div class="visible-xs column_title m-d-title"><span>[SIP22] NFT</span>
<img class=m_left_nav_click state=0 src=/img/arrow_down3.png></div><div class="content m-d-content"><article class=markdown><h2 id=nft>NFT</h2><p>NFT 的实现和扩展协议</p><h2 id=动机>动机</h2><p>在智能合约中，Token 用来表达可拆分的数字资源，而要表达不可拆分的资源，就需要 NFT。在 Move 中，任何一个不可 copy 和 drop 的类型实例，都可以认为是一个不可拆分的资源，是一个 NFT。但 NFT 需要一种统一展示的标准，以及 NFT 的收集和转移方法，所以设计本标准。</p><h2 id=目标>目标</h2><p>提供一种通用的，可扩展的标准，同时提供 NFT 相关的基本操作实现。</p><h2 id=类型定义>类型定义</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>NFT</span><span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span> has store {
        <span style=color:#e6db74>/// The creator of NFT
</span><span style=color:#e6db74></span>        creator: <span style=color:#a6e22e>address</span>,
        <span style=color:#e6db74>/// The unique id of NFT under NFTMeta type
</span><span style=color:#e6db74></span>        id: <span style=color:#66d9ef>u64</span>,
        <span style=color:#e6db74>/// The metadata of NFT
</span><span style=color:#e6db74></span>        base_meta: <span style=color:#a6e22e>Metadata</span>,
        <span style=color:#e6db74>/// The extension metadata of NFT
</span><span style=color:#e6db74></span>        type_meta: <span style=color:#a6e22e>NFTMeta</span>,
        <span style=color:#e6db74>/// The body of NFT, NFT is a box for NFTBody
</span><span style=color:#e6db74></span>        body: <span style=color:#a6e22e>NFTBody</span>,
}
</code></pre></div><p>NFT 是 Move 中的一种类型，它支持 store ability，但不可 copy 以及 drop，包含一些基本的元信息：</p><ol><li>creator: NFT 创建者的 address。</li><li>id: 该 NFT 类型下的唯一 id。</li><li>base_meta: 基础的通用 metadata 信息，主要用来表达如何展示 NFT。</li><li>type_meta: 开发者自定义的 metadata，同时用来标记 NFT 的类型。Metadata 不是资源，它表达信息，所以支持 copy + store + drop。</li><li>body: NFT 包含的资源，可以用来嵌入其他的资源。</li></ol><p>如果把 NFT 识为一个箱子，NFT 本身定义了这个箱子的归属，唯一编号，以及展示方式，而 NFTBody 就是箱子中封装的珠宝。展示方式通过 Metadata 来定义。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Metadata</span> has copy, store, drop {
        <span style=color:#e6db74>/// NFT name&#39;s utf8 bytes.
</span><span style=color:#e6db74></span>        name: <span style=color:#a6e22e>vector</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span>,
        <span style=color:#e6db74>/// Image link, such as ipfs://xxxx
</span><span style=color:#e6db74></span>        image: <span style=color:#a6e22e>vector</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span>,
        <span style=color:#e6db74>/// Image bytes data, image or image_data can not empty for both.
</span><span style=color:#e6db74></span>        image_data: <span style=color:#a6e22e>vector</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span>,
        <span style=color:#e6db74>/// NFT description utf8 bytes.
</span><span style=color:#e6db74></span>        description: <span style=color:#a6e22e>vector</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span>,
}
</code></pre></div><p>Metadata 定义了 NFT 展示所需要的基本信息，名称，图片，描述。如果有其他需要扩展的信息，可以定义在 type_meta 中。图片有两个字段表达，<code>image</code> 表示图片地址，<code>image_data</code> 可以直接保存图片的二进制数据，客户端展示的时候，使用 <code>image</code> 和 <code>image_data</code> 中不为空的那个字段。</p><p>另外，有的 NFT 的所有实例会使用同一个图片，这种情况下，NFT metadata 中的 <code>image</code> 和 <code>image_data</code> 可以都为空，客户端展示的时候使用 NFTTypeInfo 中的 metadata。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust> <span style=color:#e6db74>/// The info of NFT type
</span><span style=color:#e6db74></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>NFTTypeInfo</span><span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTTypeInfoExt: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop<span style=color:#f92672>&gt;</span> has key, store {
        counter: <span style=color:#66d9ef>u64</span>,
        meta: <span style=color:#a6e22e>Metadata</span>,
        info: <span style=color:#a6e22e>NFTTypeInfoExt</span>,
        mint_events: <span style=color:#a6e22e>Event</span>::EventHandle<span style=color:#f92672>&lt;</span>MintEvent<span style=color:#f92672>&lt;</span>NFTMeta<span style=color:#f92672>&gt;&gt;</span>,
}
</code></pre></div><p>NFTTypeInfo 用于维护 NFT id 的计数器，以及该 NFT 类型的全局 metata，每一种 NFT 类型需要先在注册中心注册。</p><h2 id=方法定义>方法定义</h2><p>每种 NFT 的类型需要先注册，注册时需要 NFT 的标记类型 NFTMeta 以及该类型的全局 metadata。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust>public fun register<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTTypeInfoExt: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop<span style=color:#f92672>&gt;</span>(sender: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>signer</span>, info: <span style=color:#a6e22e>NFTTypeInfoExt</span>, meta: <span style=color:#a6e22e>Metadata</span>)
</code></pre></div><p>注册后 <code>sender</code> 账号下会被写入三个权限：</p><ol><li>MintCapability : 用于铸造该类型的 NFT</li><li>BurnCapability：用于烧毁该类型的 NFT</li><li>UpdateCapability：用于更新该类型的 NFT metadata</li></ol><p>这三个权限对应三个方法：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#e6db74>/// 铸造 NFT，返回 NFT 的实例
</span><span style=color:#e6db74></span>public fun mint_with_cap<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span>, Info: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop<span style=color:#f92672>&gt;</span>(creator: <span style=color:#a6e22e>address</span>, cap: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>mut</span> MintCapability<span style=color:#f92672>&lt;</span>NFTMeta<span style=color:#f92672>&gt;</span>, base_meta: <span style=color:#a6e22e>Metadata</span>, type_meta: <span style=color:#a6e22e>NFTMeta</span>, body: <span style=color:#a6e22e>NFTBody</span>): <span style=color:#a6e22e>NFT</span><span style=color:#f92672>&lt;</span>NFTMeta, NFTBody<span style=color:#f92672>&gt;</span>

<span style=color:#e6db74>///烧毁 NFT，返回 NFT 内部嵌套的 NFTBody
</span><span style=color:#e6db74></span>public fun burn_with_cap<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span>(cap: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>mut</span> BurnCapability<span style=color:#f92672>&lt;</span>NFTMeta<span style=color:#f92672>&gt;</span>, nft: <span style=color:#a6e22e>NFT</span><span style=color:#f92672>&lt;</span>NFTMeta, NFTBody<span style=color:#f92672>&gt;</span>): <span style=color:#a6e22e>NFTBody</span> 

<span style=color:#e6db74>///更新 NFT 的 metadata
</span><span style=color:#e6db74></span>public fun update_meta_with_cap<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span>(cap: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>mut</span> UpdateCapability<span style=color:#f92672>&lt;</span>NFTMeta<span style=color:#f92672>&gt;</span>, nft: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>mut</span> NFT<span style=color:#f92672>&lt;</span>NFTMeta, NFTBody<span style=color:#f92672>&gt;</span>, base_meta: <span style=color:#a6e22e>Metadata</span>, type_meta: <span style=color:#a6e22e>NFTMeta</span>)
</code></pre></div><p>上面列举了 NFT 相关的基本方法，而 NFT 如何存储，如何转让，这个不是 NFT 模块本身关心的事情，是 NFTGallery 的功能。</p><h2 id=nft-陈列室nftgallery>NFT 陈列室（NFTGallery）</h2><p>NFTGallery 模块提供了用户用来收集和存储 NFT 的基本功能。主要包含以下方法：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#e6db74>/// 初始化一个 NFTGallery 去接受类型为 NFT&lt;NFTMeta, NFTBody&gt; 的 NFT，用户每接受一种新的 NFT，都需要调用这个方法初始化。
</span><span style=color:#e6db74></span>public fun accept<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span>(sender: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>signer</span>)

<span style=color:#e6db74>/// 将 id 为参数 `id` 的 NFT 从 `sender` 转给 `receiver`
</span><span style=color:#e6db74></span>public fun transfer<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span>(sender: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>signer</span>, id: <span style=color:#66d9ef>u64</span>, receiver: <span style=color:#a6e22e>address</span>)

<span style=color:#e6db74>/// 获取 `ownder` 的类型为 NFTMeta 的所有 NFT info, 返回 NFTInfo 列表
</span><span style=color:#e6db74></span>public fun get_nft_infos<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span>(owner: <span style=color:#a6e22e>address</span>):<span style=color:#a6e22e>vector</span><span style=color:#f92672>&lt;</span>NFT::NFTInfo<span style=color:#f92672>&lt;</span>NFTMeta<span style=color:#f92672>&gt;&gt;</span>
   
<span style=color:#e6db74>/// 将 `nft` 存放到 `sender` 的 NFTGallery 中
</span><span style=color:#e6db74></span>public fun deposit<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span>(sender: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>signer</span>, nft: <span style=color:#a6e22e>NFT</span><span style=color:#f92672>&lt;</span>NFTMeta, NFTBody<span style=color:#f92672>&gt;</span>)

<span style=color:#e6db74>/// 将 `nft` 存放到 `receiver` 的 NFTGallery
</span><span style=color:#e6db74></span>public fun deposit_to<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span>(receiver: <span style=color:#a6e22e>address</span>, nft: <span style=color:#a6e22e>NFT</span><span style=color:#f92672>&lt;</span>NFTMeta, NFTBody<span style=color:#f92672>&gt;</span>)

<span style=color:#e6db74>/// 从 `sender` 的 NFTGallery 中取一个类型为 NFTMeta NFT
</span><span style=color:#e6db74></span>public fun withdraw_one<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span>(sender: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>signer</span>): <span style=color:#a6e22e>NFT</span><span style=color:#f92672>&lt;</span>NFTMeta, NFTBody<span style=color:#f92672>&gt;</span>

<span style=color:#e6db74>/// 从 `sender` 的 NFTGallery 中取一个类型为 NFTMeta，id 为参数 `id` 的 NFT
</span><span style=color:#e6db74></span>public fun withdraw<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span>(sender: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>signer</span>, id: <span style=color:#66d9ef>u64</span>): Option<span style=color:#f92672>&lt;</span>NFT<span style=color:#f92672>&lt;</span>NFTMeta, NFTBody<span style=color:#f92672>&gt;&gt;</span>
</code></pre></div><p>NFTGallery 提供了一个通用的空间用来存储和查询 NFT，当然，开发者也可以自行设计 NFT 的存储模块。</p><h2 id=扩展方式>扩展方式</h2><h3 id=自定义-metadata>自定义 Metadata</h3><p>如果开发者需要增加新的 Metadata，可以在 NFTMeta 类型中定义，例如要定义一个视频类的 NFT，需要增加一个视频地址：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>VideoNFT</span> has copy, store, drop {
  video_url: <span style=color:#a6e22e>vector</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span>,
}
<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>VideoNFTBody</span> has store{}
</code></pre></div><p>实际的 NFT 数据格式相当于：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>NFT</span>{
  creator: <span style=color:#a6e22e>address</span>,
  id: <span style=color:#66d9ef>u64</span>,
  base_meta: <span style=color:#a6e22e>Metadata</span>,
  type_meta: <span style=color:#a6e22e>VideoNFT</span>,
  body: <span style=color:#a6e22e>VideoNFTBody</span>,
}
</code></pre></div><h3 id=嵌套-nftbody>嵌套 NFTBody</h3><p>如果开发者想再 NFT 中嵌入其他的资源，可以通过自定义 Body 的方式进行，比如上面的 VideoNFTBody 中想嵌入一些 Token：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>VideoNFTBody</span> has store{
  token: <span style=color:#a6e22e>Token</span><span style=color:#f92672>&lt;</span>STC<span style=color:#f92672>&gt;</span>,
}
</code></pre></div><h3 id=自定义转让逻辑>自定义转让逻辑</h3><p>有的 NFT 应用场景下，NFT 转让是受限的，比如作为会员凭证。这种情况下，需要自定义一种 NFT 的存储机制，从而实现自定义转让机制。储存在 NFTGallery 中的 NFT，完全受用户控制，NFT 的开发者不能限制它的使用和转让。</p><p>以 IdentifierNFT 为例， IdentifierNFT 是一种 NFT 容器，它保证每个用户只能拥有一个同一个类型的 NFT，NFT 开发者授予用户 NFT 后，用户无法转让，一般用在用户身份相关的 NFT 场景下，比如荣誉奖章等。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#e6db74>/// IdentifierNFT 中包含了一个 Option 的 NFT，默认是空的，相当于一个可以容纳 NFT 的箱子
</span><span style=color:#e6db74></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>IdentifierNFT</span><span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span> has key {
        nft: Option<span style=color:#f92672>&lt;</span>NFT<span style=color:#f92672>&lt;</span>NFTMeta, NFTBody<span style=color:#f92672>&gt;&gt;</span>,
}

<span style=color:#e6db74>/// 用户通过 Accept 方法初始化一个空的 IdentifierNFT 在自己的账号下
</span><span style=color:#e6db74></span>public fun accept<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span>(sender: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>signer</span>) {
  move_to(sender, IdentifierNFT<span style=color:#f92672>&lt;</span>NFTMeta, NFTBody<span style=color:#f92672>&gt;</span> {
    nft: Option::none(),
  });
}

<span style=color:#e6db74>/// 开发者通过 MintCapability 给 receiver 授予该 nft，将 nft 嵌入到 IdentifierNFT 中
</span><span style=color:#e6db74></span>public fun grant_to<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span>(_cap: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>mut</span> MintCapability<span style=color:#f92672>&lt;</span>NFTMeta<span style=color:#f92672>&gt;</span>, receiver: <span style=color:#a6e22e>address</span>, nft: <span style=color:#a6e22e>NFT</span><span style=color:#f92672>&lt;</span>NFTMeta, NFTBody<span style=color:#f92672>&gt;</span>) acquires IdentifierNFT {
     <span style=color:#66d9ef>let</span> id_nft <span style=color:#f92672>=</span> borrow_global_mut<span style=color:#f92672>&lt;</span>IdentifierNFT<span style=color:#f92672>&lt;</span>NFTMeta, NFTBody<span style=color:#f92672>&gt;&gt;</span>(receiver);
     Option::fill(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> id_nft.nft, nft);
}

<span style=color:#e6db74>/// 开发者也可以通过 BurnCapability 将 `owner` IdentifierNFT 中的 NFT 取出来
</span><span style=color:#e6db74></span>public fun revoke<span style=color:#f92672>&lt;</span>NFTMeta: <span style=color:#a6e22e>copy</span> <span style=color:#f92672>+</span> store <span style=color:#f92672>+</span> drop, NFTBody: <span style=color:#a6e22e>store</span><span style=color:#f92672>&gt;</span>(_cap: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>mut</span> BurnCapability<span style=color:#f92672>&lt;</span>NFTMeta<span style=color:#f92672>&gt;</span>, owner: <span style=color:#a6e22e>address</span>): <span style=color:#a6e22e>NFT</span><span style=color:#f92672>&lt;</span>NFTMeta, NFTBody<span style=color:#f92672>&gt;</span>  acquires IdentifierNFT {
     <span style=color:#66d9ef>let</span> id_nft <span style=color:#f92672>=</span> move_from<span style=color:#f92672>&lt;</span>IdentifierNFT<span style=color:#f92672>&lt;</span>NFTMeta, NFTBody<span style=color:#f92672>&gt;&gt;</span>(owner);
     <span style=color:#66d9ef>let</span> IdentifierNFT { nft } <span style=color:#f92672>=</span> id_nft;
     Option::destroy_some(nft)
}
</code></pre></div><p>以上的方案中，NFTMeta 定义和注册的开发者可以通过程序来定义 NFT 的转让逻辑（当然，也可以不允许转让）。</p><h2 id=使用场景示例>使用场景示例</h2><h3 id=nft-游戏道具>NFT 游戏道具</h3><p>用 Move 中的 NFT 来定义游戏道具的一个优势是可以在同一个 Module 中定义多个 NFT 类型，还可以实现道具间的组合，比如：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#e6db74>/// 玩家通过两个 L1 的 Card 合成一个新的 L2 的 Card   
</span><span style=color:#e6db74></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>L1Card</span> has store {}
<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>L2Card</span> has store {
     first: <span style=color:#a6e22e>L1Card</span>,
     second: <span style=color:#a6e22e>L1Card</span>,
 }
</code></pre></div><p>更详细的例子参看 <a href=https://github.com/starcoinorg/starcoin/blob/master/vm/functional-tests/tests/testsuite/nft/nft_card.move>nft_card.move</a></p><h3 id=nft-作为会员身份>NFT 作为会员身份</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#e6db74>/// XMembership NFTMeta 中记录了会员的开始时间以及结束时间
</span><span style=color:#e6db74></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>XMembership</span> has copy, store, drop{
    join_time: <span style=color:#66d9ef>u64</span>,
    end_time: <span style=color:#66d9ef>u64</span>,
}
<span style=color:#e6db74>/// XMembership NFTBody 中锁了用户的会员费
</span><span style=color:#e6db74></span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>XMembershipBody</span> has store{
    fee: <span style=color:#a6e22e>Token</span><span style=color:#f92672>&lt;</span>STC<span style=color:#f92672>&gt;</span>,
}
</code></pre></div><p>用户缴会员费成为会员后，会员费是锁在 NFT 中的，只有用户每次进行会员操作或者退出的时候，会检查会员是否到期并按时间流扣除会员费。更详细的例子参看 <a href=https://github.com/starcoinorg/starcoin/blob/master/vm/functional-tests/tests/testsuite/nft/identifier_nft.move>identifier_nft.move</a></p><h3 id=nft-作为购物凭证>NFT 作为购物凭证</h3><p>用户直接通过支付 Token 在链上自行铸造 NFT，然后用 NFT 来兑换实物。用户之间可以交易 NFT。更详细的例子参看 <a href=https://github.com/starcoinorg/starcoin/blob/master/vm/functional-tests/tests/testsuite/nft/nft_boxminer.move>nft_boxminer.move</a></p><h3 id=通过-merkletree-证明来分发-nft>通过 MerkleTree 证明来分发 NFT</h3><p>有些 NFT 要分发给那些账号地址是确定的，但由于数量较多，无法一次性铸造出来，可以通过 MerkleTree 证明来分发。NFT 开发者定义 NFT 并在链上提交 MerkleTree 的 root，用户拿着 NFT 证明来自行铸造。</p><p>Starcoin 的 GenesisNFT 就是通过这种方式铸造的。GenesisNFT 分发给 starcoin 主网启动前参与 Barnard 网络挖矿的账号地址。主网创世块的 parent_hash(0x0f2fdd39d11dc3d25f21d05078783d476ff98ca4035320e5932bb3938af0e827) 指向的 Barnard 网络的区块，高度为 310000。Barnard 网络上在此高度之前所有出过块的地址，都可以自行铸造一枚 GenesisNFT。详细实现参看：<a href=https://github.com/starcoinorg/starcoin/blob/master/vm/stdlib/modules/GenesisNFT.move>GenesisNFT.move</a> <a href=https://github.com/starcoinorg/starcoin/blob/master/vm/stdlib/modules/MerkleNFT.move>MerkleNFT.move</a></p><h2 id=starcoin-nft-标准与-erc721erc1155-之间的差异>Starcoin NFT 标准与 ERC721/ERC1155 之间的差异</h2><ol><li>ERC721/ERC1155 是 Interface，并没有定义实现，可扩展性通过不同的实现来完成。而 Starcoin NFT 标准包含数据类型与基本操作的实现，可扩展性通过上层组合来实现。</li><li>默认情况下，Starcoin NFT 和 ERC721 类似，是不可拆分的。但第三方可以自行扩展出拆分和合并逻辑，从而达到 ERC1155 的目的。</li><li>ERC721/ERC1155 的 NFT 都只能在合约内部移动，无法从合约移动到另外一个合约，所以 NFT 之上的协议组合非常困难。而得益于 Move 的类型特征，Starcoin 中的 NFT 可以在不同的合约之间移动，其他的合约可以定义新的类型来对 NFT 进行封装，扩展出新的转让逻辑（比如拍卖）。这给 NFT 之上的协议设计带来了极大的便利，可以组合出很多的玩法。</li><li>ERC721/ERC1155 是通过合约地址来区分 NFT 类型的，要想实现多种 NFT，需要部署多个合约，如果 NFT 类型很多的情况，会导致合约调用非常复杂。</li><li>Starcoin 的 NFT 存储在用户的状态空间里，可以通过列举用户状态空间的资源来展示用户所有的 NFT，包括嵌入到其他合约中的 NFT。这给周边生态工具，比如钱包以及区块浏览器中中展示 NFT，拍卖市场展示 NFT 等，都带来了极大的便利。</li></ol></article></div></div></div><div id=dev_fixed_back class=code_fixed_back><div class=code_model><div class=head><div id=popup_close class=popup_close><img src=/img/close.png></div></div><div class=m_dev_list><ul><li><a href=/zh/developer/setup/ class=arrow>从这里开始</a></li><li><a href=/zh/developer/cli/ class=arrow>命令行工具</a></li><li><a href=/zh/developer/tutorials/ class=arrow>教程</a></li><li><a href=/zh/developer/move/ class=arrow>Move 语言</a></li><li><a href=/zh/developer/key_concepts/ class=arrow>关键概念</a></li><li><a href=/zh/developer/rpc/ class=arrow>RPC</a></li><li><a href=/zh/developer/release-notes/ class=arrow>版本记录</a></li><li><a href=/zh/developer/sdk/>SDK</a><ul></ul></li><li><a href=/zh/developer/account/ class=arrow>Starcoin账户说明</a></li><li><a href=/zh/developer/sips/sip-22/ class=active>[SIP22] NFT</a></li><li><a href=/zh/developer/tech/ class=arrow>技术</a></li><li><a href=/zh/developer/protocols/starcoin_nft/>NFT 协议</a></li></ul></div></div></div></div><div class="footer visible-lg"><div class=container><div class=hr><div class="col-md-6 item logo-container" style=width:60%><a href=/zh><div class=logo><img src=/img/logo.png></div></a>© 2018-2021 Starcoin.org</div><div class="col-md-3 item" style=width:25%>技术</div><div class="col-md-3 item" style=width:15%>社区</div></div><div class=td><div class="col-md-6 item" style=width:60%></div><div class="col-md-3 item" style=width:25%><a target=_blank href="https://chrome.google.com/webstore/detail/starmask/mfhbebgoclkghebffdldpobeajmbecfk?hl=zh-CN">StarMask 插件钱包</a></div><div class="col-md-3 item" style=width:15%><a target=_blank href=https://starcoin.org/zh/news/>新闻</a></div></div><div class=td><div class="col-md-6 item" style=width:60%></div><div class="col-md-3 item" style=width:25%><a target=_blank href=https://stcscan.io>区块浏览器</a></div><div class="col-md-3 item" style=width:15%><a target=_blank href=https://westar.io>Westar 实验室</a></div></div><div class=td><div class="col-md-6 item" style=width:60%></div><div class="col-md-3 item" style=width:25%><a target=_blank href=https://starcoin.org/zh/developer/>开发者文档</a></div><div class="col-md-3 item" style=width:15%><a target=_blank href=https://www.movelang.io>Move 中文社区</a></div></div><div class=td><div class="col-md-6 item contact-container" style=width:60%><span data-toggle=tooltip data-placement=bottom title="微信公众号: Starcoin区块链"><img src=/img/footer/wechat@2x.png></span>
<span data-toggle=tooltip data-placement=bottom title="推特: StarcoinSTC"><a href=https://twitter.com/starcoinstc target=_blank><img src=/img/footer/twitter@2x.png></a></span>
<span data-toggle=tooltip data-placement=bottom title="微信群请加: starcoinorg"><img src=/img/footer/wechat_group@2x.png></span>
<span data-toggle=tooltip data-placement=bottom title="Discord 群: Discord Spaceship"><a href=https://discord.gg/96tKt5exaE target=_blank><img src=/img/footer/discord@2x.png></span></div><div class="col-md-3 item" style=width:25%><a target=_blank href=https://starcoin.org/zh/developer/sdk/>SDK</a></div><div class="col-md-3 item" style=width:15%><a target=_blank href=https://github.com/starcoinorg/starcoin/discussions>GitHub 讨论区</a></div></div></div></div><div class="m-footer visible-xs visible-sm visible-md"><div class=container><div class=go-contact-us>技术</div><div class=row-li><div class=item><a target=_blank href="https://chrome.google.com/webstore/detail/starmask/mfhbebgoclkghebffdldpobeajmbecfk?hl=zh-CN">StarMask 插件钱包</a></div><div class=item><a target=_blank href=https://stcscan.io>区块浏览器</a></div><div class=item><a target=_blank href=https://starcoin.org/zh/developer/>开发者文档</a></div><div class=item><a target=_blank href=https://starcoin.org/zh/developer/sdk/>SDK</a></div></div><div class=go-contact-us>社区</div><div class=row-li><div class=item><a target=_blank href=https://starcoin.org/zh/news/>新闻</a></div><div class=item><a target=_blank href=https://westar.io>Westar 实验室</a></div><div class=item><a target=_blank href=https://www.movelang.io>Move 中文社区</a></div><div class=item><a target=_blank href=https://github.com/starcoinorg/starcoin/discussions>GitHub 讨论区</a></div></div><div class=go-contact-us>联系我们</div><div class=row-li><div class=item>微信公众号: Starcoin区块链</div><div class=item>微信群请加: starcoinorg</div></div><div class=row-li><div class=item><a target=_blank href=https://twitter.com/starcoinstc>推特: StarcoinSTC</a></div><div class=item><a target=_blank href=https://discord.gg/96tKt5exaE>Discord 群: Discord Spaceship</a></div></div><div class=crt>© 2018-2021 Starcoin.org</div></div></div></body></html><script>$(document).ready(function(){$("#popup_close").click(function(){$("#dev_fixed_back").hide()}),$(".m-d-title").click(function(){$("#dev_fixed_back").show()}),$(".developer_right a").each(function(a,b){$(this).attr('href').indexOf('http')!=-1&&$(this).attr('target','_blank')})})</script>