<!doctype html><html lang=zh><head><meta charset=utf-8><meta content="width=device-width;initial-scale=1;maximum-scale=1;user-scalable=0" name=viewport><meta id=i18n_pagename content="index-common"><link rel=stylesheet type=text/css href=/css/bootstrap.css><link rel=stylesheet href=/css/swiper-bundle.css><link rel=stylesheet type=text/css href=/css/nav.css><link rel=stylesheet type=text/css href=/css/banner.css><link rel=stylesheet type=text/css href=/css/footer.css><link rel=stylesheet type=text/css href=/css/developer.css><link rel=stylesheet type=text/css href=/css/markdown.css><script src=/js/jquery.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/swiper-bundle.min.js></script><script>(function(c,d){const b=196;function a(){const c=document.documentElement.clientWidth/1920,a=b*Math.min(c,2);document.documentElement.style.fontSize=a+'px',console.log('resize',document.documentElement.clientWidth,document.documentElement.clientHeight,'fontSize',a)}addEventListener('resize',a,!1),a()})(document,window)</script><script>$(document).ready(function(){a(),$(window).resize(function(){a()});function a(){navigator.userAgent.match(/mobile/i)?($(".m-d-title").css("width",document.body.clientWidth-30+'px'),$(".m-d-content").css("width",document.body.clientWidth-30+'px')):($(".m-d-title").css("width","auto"),$(".m-d-content").css("width","auto"))}$("#developer_open_move").click(function(){$(this).parent().attr("class").indexOf("active")>-1?($(this).find(".icon img").attr("src","/img/icon_block.png"),$(this).parent().removeClass("active")):($(this).find(".icon img").attr("src","/img/icon_block_active.png"),$(this).parent().addClass("active"))}),$(".m_left_nav_click").click(function(){$(this).attr("state")==0?($(this).attr("state",1),$(".m_mask").show(),$(".m-column-drawer").animate({marginLeft:"100px"})):($(this).attr("state",0),$(".m_mask").hide(),$(".m-column-drawer").animate({marginLeft:"-212px"}))}),$(".m_mask").click(function(){$(this).hide(),$(".m_left_nav_click").attr("state",0),$(".m-column-drawer").animate({marginLeft:"-212px"})})})</script><title>通过治理机制修改链上配置 | Starcoin 开发者</title></head><body><div class=visible-lg-block><div class=header_top></div><div class="top scrollTop-nav"><div class=container><a href=/zh><div class=logo><img src=/img/logo.png></div></a><div class="nav navClick"><div class="item Overview allSelect"><span class=i18n>首页</span><div class=more_nav><div class=box><div class=li><a class=i18n onclick="return window.open('https://developer.starcoin.org/zh/sips/sip-2/',''),!1" href=javascript:void(0)>技术白皮书</a></div><div class=li><a class=i18n onclick="return window.open('https://developer.starcoin.org/zh/sips/sip-3/',''),!1" href=javascript:void(0)>经济模型白皮书</a></div></div></div></div><div class="item Guide allSelect"><span class=i18n>使用指南</span><div class=more_nav><div class=box><div class=li><a class=i18n onclick="return window.open('https://github.com/starcoinorg/starmask-extension/blob/main/docs/how-to-install.md',''),!1" href=javascript:void(0)>安装 Starmask 钱包</a></div><div class=li><a class=i18n onclick="return window.open('https://github.com/starcoinorg/starmask-extension/blob/main/docs/how-to-use.md',''),!1" href=javascript:void(0)>使用 Starmask 钱包</a></div><div class=li><a class=i18n onclick="return window.open('https://explorer.starcoin.org',''),!1" href=javascript:void(0)>区块链浏览器</a></div><div class=li><a class=i18n onclick="return window.open('https://starcoin-miner.gitbook.io/starcoin-miner-guide/',''),!1" href=javascript:void(0)>STC挖矿</a></div><div class=li><a class=i18n onclick="return window.open('https://developer.starcoin.org/zh/cli/',''),!1" href=javascript:void(0)>节点命令行</a></div></div></div></div><div class="item Developer allSelect"><span class=i18n>开发者</span><div class=more_nav><div class=box><div class=li><a class=i18n href=/zh/developer/setup/>安装并加入网络</a></div><div class=li><a class=i18n href=/zh/developer/rpc/rpc_document/>RPC协议接口</a></div><div class=li><a class=i18n href=/zh/developer/sips/>SIP</a></div><div class=li><a class=i18n href=/zh/developer/sdk/>Python 和 JS SDK</a></div><div class=li><a class=i18n href=https://move-book.com/cn/index.html>Move 开发指南</a></div><div class=li><a class=i18n href=https://github.com/starcoinorg/starcoin/commit/23ee860a3213f25386b26929307bf851b5af34f9>Move CLI</a></div><div class=li><a class=i18n href=/zh/developer/tutorials/>Move 合约示例</a></div><div class=li><a class=i18n href=https://github.com/starcoinorg/starcoin/discussions/2541>矿池接入</a></div></div></div></div><div class="item Community allSelect"><span class=i18n>社区</span><div class=more_nav><div class=box><div class=li><a class=i18n href=/zh/news/>新闻</a></div><div class=li><a class=i18n onclick="return window.open('http://westar.io',''),!1" href=javascript:void(0)>Westar 实验室</a></div><div class=li><a class=i18n onclick="return window.open('https://twitter.com/StarcoinSTC',''),!1" href=javascript:void(0)>Twitter</a></div><div class=li><a class=i18n onclick="return window.open('https://www.movelang.io',''),!1" href=javascript:void(0)>Move 中文社区</a></div><div class=li><a class=i18n onclick="return window.open('https://developer.starcoin.org',''),!1" href=javascript:void(0)>文档</a></div></div></div></div><div class="item QA allSelect"><span class=i18n>问答</span><div class=more_nav><div class=box><div class=li><a class=i18n onclick="return window.open('https://github.com/starcoinorg/starcoin/discussions',''),!1" href=javascript:void(0)>GitHub 讨论区</a></div><div class=li><a class=i18n onclick="return window.open('https://explorer.starcoin.org/faq',''),!1" href=javascript:void(0)>Starcoin 常见问题</a></div></div></div></div><div class="item About allSelect"><span class=i18n>关于</span><div class=more_nav><div class=box><div class=li><a class=i18n href=/zh/about>关于 Starcoin</a></div></div></div></div></div><div class="language p-language"><span language=en>English</span>｜<span language=zh>中文</span></div></div></div></div><div class="visible-xs visible-sm visible-md" style=display:none><div class="header_top m_header_top"></div><div class="top m_top scrollTop-nav"><div class="container m_container"><a href=/><div class=m_logo><img src=/img/logo.png></div></a><div class="m_nav m_nav_tap"><img src=/img/m_nav_more.png></div></div></div><div class=m_nav_model><div class="nav navClick m_nav_navigation"><div class="item Overview allSelect"><span class=i18n>首页</span><div class=more_nav><div class=box><div class=li><a class=i18n onclick="return window.open('https://developer.starcoin.org/zh/sips/sip-2/',''),!1" href=javascript:void(0)>技术白皮书</a></div><div class=li><a class=i18n onclick="return window.open('https://developer.starcoin.org/zh/sips/sip-3/',''),!1" href=javascript:void(0)>经济模型白皮书</a></div></div></div></div><div class="item Guide allSelect"><span class=i18n>使用指南</span><div class=more_nav><div class=box><div class=li><a class=i18n onclick="return window.open('https://github.com/starcoinorg/starmask-extension/blob/main/docs/how-to-install.md',''),!1" href=javascript:void(0)>安装 Starmask 钱包</a></div><div class=li><a class=i18n onclick="return window.open('https://github.com/starcoinorg/starmask-extension/blob/main/docs/how-to-use.md',''),!1" href=javascript:void(0)>使用 Starmask 钱包</a></div><div class=li><a class=i18n onclick="return window.open('https://explorer.starcoin.org',''),!1" href=javascript:void(0)>区块链浏览器</a></div><div class=li><a class=i18n onclick="return window.open('https://starcoin-miner.gitbook.io/starcoin-miner-guide/',''),!1" href=javascript:void(0)>STC挖矿</a></div><div class=li><a class=i18n onclick="return window.open('https://developer.starcoin.org/zh/cli/',''),!1" href=javascript:void(0)>节点命令行</a></div></div></div></div><div class="item Developer allSelect"><span class=i18n>开发者</span><div class=more_nav><div class=box><div class=li><a class=i18n href=/zh/developer/setup/>安装并加入网络</a></div><div class=li><a class=i18n href=/zh/developer/rpc/rpc_document/>RPC协议接口</a></div><div class=li><a class=i18n href=/zh/developer/sips/>SIP</a></div><div class=li><a class=i18n href=/zh/developer/sdk/>Python 和 JS SDK</a></div><div class=li><a class=i18n href=https://move-book.com/cn/index.html>Move 开发指南</a></div><div class=li><a class=i18n href=https://github.com/starcoinorg/starcoin/commit/23ee860a3213f25386b26929307bf851b5af34f9>Move CLI</a></div><div class=li><a class=i18n href=/zh/developer/tutorials/>Move 合约示例</a></div><div class=li><a class=i18n href=https://github.com/starcoinorg/starcoin/discussions/2541>矿池接入</a></div></div></div></div><div class="item Community allSelect"><span class=i18n>社区</span><div class=more_nav><div class=box><div class=li><a class=i18n href=/zh/news/>新闻</a></div><div class=li><a class=i18n onclick="return window.open('http://westar.io',''),!1" href=javascript:void(0)>Westar 实验室</a></div><div class=li><a class=i18n onclick="return window.open('https://twitter.com/StarcoinSTC',''),!1" href=javascript:void(0)>Twitter</a></div><div class=li><a class=i18n onclick="return window.open('https://www.movelang.io',''),!1" href=javascript:void(0)>Move 中文社区</a></div><div class=li><a class=i18n onclick="return window.open('https://developer.starcoin.org',''),!1" href=javascript:void(0)>文档</a></div></div></div></div><div class="item QA allSelect"><span class=i18n>问答</span><div class=more_nav><div class=box><div class=li><a class=i18n onclick="return window.open('https://github.com/starcoinorg/starcoin/discussions',''),!1" href=javascript:void(0)>GitHub 讨论区</a></div><div class=li><a class=i18n onclick="return window.open('https://explorer.starcoin.org/faq',''),!1" href=javascript:void(0)>Starcoin 常见问题</a></div></div></div></div><div class="item About allSelect"><span class=i18n>关于</span><div class=more_nav><div class=box><div class=li><a class=i18n href=/zh/about>关于 Starcoin</a></div></div></div></div></div><div class=m-language><div language=zh class=item>中文<div class=line></div></div><div language=en class=item>English</div></div></div><div class=clearfix></div></div><script>$(document).ready(function(){$(".p-language span, .m-language .item").click(function(){let a=window.location.href,b=$(this).attr('language'),c="zh";c!==b&&(a=a.replace(`/${c}/`,`/${b}/`),window.location.href=a)}),$(".navClick .item").click(function(){$(this).attr("href")&&window.open($(this).attr("href"),"_self")}),$(".more_nav .box .li").click(function(){$(this).attr("href")&&window.open($(this).attr("href"),"_self")}),$(".m_nav_navigation").find(".allSelect").click(function(){$(this).attr("class").indexOf("m_tab_select")>-1?(console.log($(this)),$(this).removeClass("m_tab_select")):$(this).addClass("m_tab_select")}),$(".m_nav_tap").click(function(){$(this).find("img").attr("src")=="/img/m_nav_more.png"?($(this).find("img").attr("src","/img/m_nav_close.png"),$(".m_nav_model").show(),$(".m_nav_model").animate({height:"100%"}),$(".scrollTop-nav").addClass("home-nav")):($(this).find("img").attr("src","/img/m_nav_more.png"),$(".scrollTop-nav").removeClass("home-nav"),$(".m_nav_model").animate({height:"0%"}),$(".m_nav_model").hide())})})</script><div class=container><div class="developer m-column-drawer"><div class=developer_left><div class=developer_column>Starcoin 开发者</div><div class=developer_column_list><div class=developer_search><div class=search><div class=icon><img src=/img/search.png></div><input type=text placeholder=搜索 name=fname></div></div><ul><li><a href=/zh/developer/setup/>从这里开始</a><ul><li><a href=/zh/developer/setup/install/>安装</a></li><li><a href=/zh/developer/setup/build/>从源码构建</a></li><li><a href=/zh/developer/setup/run_by_docker/>通过 docker 运行</a></li><li><a href=/zh/developer/setup/runnetwork/>运行/加入网络</a></li><li><a href=/zh/developer/setup/runcustomnetwork/>运行自定义的区块链网络</a></li></ul></li><li><a href=/zh/developer/cli/ class=arrow>命令行工具</a><ul><li><a href=/zh/developer/cli/console/>使用 starcoin 控制台</a></li><li><a href=/zh/developer/cli/account_manager/>账号管理</a></li><li><a href=/zh/developer/cli/first_transaction/>第一笔链上交易</a></li><li><a href=/zh/developer/cli/mint/>挖矿</a></li><li><a href=/zh/developer/cli/multisig_account/>多签账户以及多签交易</a></li><li><a href=/zh/developer/cli/modify_dao_config/>通过治理机制修改 DAO 的设置</a></li><li><a href=/zh/developer/cli/modify_onchain_config/ class=active>通过治理机制修改链上配置</a></li><li><a href=/zh/developer/cli/upgrade_module_with_dao/>通过Dao升级Module</a></li></ul></li><li><a href=/zh/developer/tutorials/ class=arrow>教程</a></li><li><a href=/zh/developer/move/ class=arrow>Move 语言</a></li><li><a href=/zh/developer/key_concepts/ class=arrow>关键概念</a></li><li><a href=/zh/developer/rpc/ class=arrow>RPC</a></li><li><a href=/zh/developer/release-notes/ class=arrow>版本记录</a></li><li><a href=/zh/developer/sdk/>SDK</a><ul></ul></li><li><a href=/zh/developer/tech/ class=arrow>技术</a></li><li><a href=/zh/developer/sips/ class=arrow>SIPs</a></li></ul></div></div><div class=developer_right><label for=menu-control class="hidden book-menu-overlay"></label><div class=m_mask></div><div class="column_title m-d-title"><img class=m_left_nav_click state=0 src=/img/m_nav_more.png>
<span>通过治理机制修改链上配置</span></div><div class="content m-d-content"><article class=markdown><p>关于链上治理的介绍请参看 <a href=../key_concepts/dao_governance/>去中心化组织治理</a>, 这是一个例子，演示如何通过 cli 修改链上配置。</p><p>下面我们看一个修改 PublishOption 的例子。</p><h2 id=修改-publishoption-的配置>修改 PublishOption 的配置：</h2><p>1.把 PublishOption 修改为 Open 状态 (缺省是Locked)，发起投票。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># 解锁节点账号，用节点账号发起提案。注意：以下用到的账户（0x3ce9c3beeb95b555f5e3f2ac297afbf1）都需要替换成自己的账户。</span>
account unlock 0x3ce9c3beeb95b555f5e3f2ac297afbf1
account execute-function -s 0x3ce9c3beeb95b555f5e3f2ac297afbf1 --function 0x1::OnChainConfigScripts::propose_update_txn_publish_option --arg true true <span style=color:#ae81ff>0</span>
</code></pre></div><p>提案发起后，用户需要等待公示期过后才能开始投票。
可以使用如下命令查看提案信息。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>dev call --function 0x1::Dao::proposal_info -t 0x1::STC::STC -t 0x1::OnChainConfigDao::OnChainConfigUpdate&lt;0x1::TransactionPublishOption::TransactionPublishOption&gt; --arg 0x3ce9c3beeb95b555f5e3f2ac297afbf1
</code></pre></div><p>返回结果包含了五个值，依次是：proposal_id，投票开始时间，投票结束时间，赞成票数，反对票数。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#f92672>&#34;ok&#34;</span>: [
    {
      <span style=color:#f92672>&#34;U64&#34;</span>: <span style=color:#e6db74>&#34;0&#34;</span>
    },
    {
      <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;U64&#34;</span>,
      <span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#ae81ff>1602596122</span>
    },
    {
      <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;U64&#34;</span>,
      <span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#ae81ff>1602599722</span>
    },
    {
      <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;U128&#34;</span>,
      <span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#ae81ff>2000000000000000</span>
    },
    {
      <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;U128&#34;</span>,
      <span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#ae81ff>0</span>
    }
  ]
}
</code></pre></div><p>2.用户投票</p><p>投票的用户需要 balance 不能为 0，可以通过挖矿或者其他账户转账的方式获得。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># 解锁投票用户</span>
account unlock 0x1ddb8ec4850de3a57dede0f82edc5ec3
account execute-function -s 0x1ddb8ec4850de3a57dede0f82edc5ec3 --function 0x1::DaoVoteScripts::cast_vote -t 0x1::STC::STC -t 0x1::OnChainConfigDao::OnChainConfigUpdate&lt;0x1::TransactionPublishOption::TransactionPublishOption&gt; --arg 0x3ce9c3beeb95b555f5e3f2ac297afbf1 --arg <span style=color:#ae81ff>0</span> --arg true --arg 2000000000000000u128
</code></pre></div><p>投票完成，需要等待投票期结束。注意，第一个参数 0 表示 proposal id 是 0。第二个参数 true 表示赞成，第三个参数是投的 token 数量。</p><p>3.执行提案</p><p>执行提案前，可以通过以下命令查看提案状态：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>dev call --function 0x1::Dao::proposal_state -t 0x1::STC::STC -t 0x1::OnChainConfigDao::OnChainConfigUpdate&lt;0x1::TransactionPublishOption::TransactionPublishOption&gt; --arg 0x3ce9c3beeb95b555f5e3f2ac297afbf1 <span style=color:#ae81ff>0</span>
</code></pre></div><p>返回：（如果返回结果是 4，说明提案通过，其他提案状态可以参考标准库文档）
注意： Dao的提案通过后的执行脚本都一样，需要注意proposal_id参数，当前示例是0</p><p>放入待执行对列：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># 用节点账号将通过后的提案入队列</span>
account execute-function -s 0x3ce9c3beeb95b555f5e3f2ac297afbf1 --function 0x1::Dao::queue_proposal_action -t 0x1::STC::STC -t 0x1::OnChainConfigDao::OnChainConfigUpdate&lt;0x1::TransactionPublishOption::TransactionPublishOption&gt; --arg 0x3ce9c3beeb95b555f5e3f2ac297afbf1 --arg <span style=color:#ae81ff>0</span>
</code></pre></div><p>检查提案状态，待执行公示期过后：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e>#必须由提案提交者发起交易执行提案。（这里有点坑，命令里节省了proposer参数，导致必须由提案提交者发起交易）</span>
account execute-function -s 0x3ce9c3beeb95b555f5e3f2ac297afbf1 --function 0x1::OnChainConfigScripts::execute_on_chain_config_proposal -t 0x1::TransactionPublishOption::TransactionPublishOption --arg <span style=color:#ae81ff>0</span>

</code></pre></div><p>4.取回质押的 Token</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>account execute-function -s 0x3ce9c3beeb95b555f5e3f2ac297afbf1 --function  0x1::DaoVoteScripts::unstake_vote -t 0x1::STC::STC -t 0x1::OnChainConfigDao::OnChainConfigUpdate&lt;0x1::TransactionPublishOption::TransactionPublishOption&gt; --arg 0x3ce9c3beeb95b555f5e3f2ac297afbf1 <span style=color:#ae81ff>0</span>
</code></pre></div><p>5.最后清理掉完成的提案，验证参数是否正确</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>account execute-function -s 0x3ce9c3beeb95b555f5e3f2ac297afbf1 --function 0x1::Dao::destroy_terminated_proposal -t 0x1::STC::STC -t 0x1::OnChainConfigDao::OnChainConfigUpdate&lt;0x1::TransactionPublishOption::TransactionPublishOption&gt; --arg 0x3ce9c3beeb95b555f5e3f2ac297afbf1 <span style=color:#ae81ff>0</span>
</code></pre></div><p>恭喜你，整个修改流程就完成了。</p><p>下面我们看一个修改 Consensus 配置的例子。</p><h2 id=修改-consensus-的配置>修改 Consensus 的配置：</h2><p>1.把 base_reward_per_block 设为新的值，发起投票。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>account execute-function -s 0x3ce9c3beeb95b555f5e3f2ac297afbf1 --function 0x1::OnChainConfigScripts::propose_update_consensus_config --arg <span style=color:#ae81ff>500</span> <span style=color:#ae81ff>10000</span> 10000000000u128 <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>240</span> <span style=color:#ae81ff>24</span> <span style=color:#ae81ff>5000</span> <span style=color:#ae81ff>60000</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>50000000</span> 3u8 <span style=color:#ae81ff>0</span>
</code></pre></div><p>提案发起后，用户需要等待公示期过后才能开始投票。
可以使用如下命令查看提案信息。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>dev call --function 0x1::Dao::proposal_info -t 0x1::STC::STC -t 0x1::OnChainConfigDao::OnChainConfigUpdate&lt;0x1::ConsensusConfig::ConsensusConfig&gt; --arg 0x3ce9c3beeb95b555f5e3f2ac297afbf1
</code></pre></div><p>2.用户投票</p><p>投票的用户需要 balance 不能为 0，可以通过挖矿或者其他账户转账的方式获得。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>account execute-function -s 0x1ddb8ec4850de3a57dede0f82edc5ec3 --function 0x1::DaoVoteScripts::cast_vote -t 0x1::STC::STC -t 0x1::OnChainConfigDao::OnChainConfigUpdate&lt;0x1::ConsensusConfig::ConsensusConfig&gt; --arg 0x3ce9c3beeb95b555f5e3f2ac297afbf1 --arg <span style=color:#ae81ff>1</span> --arg true --arg 2000000000000000u128
</code></pre></div><p>投票完成，需要等待投票期结束。注意，第一个参数 1 表示 proposal id 是 1。第二个参数 true 表示赞成，第三个参数是投的 token 数量。</p><p>3.执行提案</p><p>执行提案前，可以通过以下命令查看提案状态：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>dev call --function 0x1::Dao::proposal_state -t 0x1::STC::STC -t 0x1::OnChainConfigDao::OnChainConfigUpdate&lt;0x1::ConsensusConfig::ConsensusConfig&gt; --arg 0x3ce9c3beeb95b555f5e3f2ac297afbf1 <span style=color:#ae81ff>1</span>
</code></pre></div><p>返回：（如果返回结果是 4，说明提案通过，其他提案状态可以参考标准库文档）
注意： Dao的提案通过后的执行脚本都一样，需要注意proposal_id参数，当前示例是1</p><p>放入待执行对列：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># 用节点账号将通过后的提案入队列</span>
account execute-function -s 0x3ce9c3beeb95b555f5e3f2ac297afbf1 --function 0x1::Dao::queue_proposal_action -t 0x1::STC::STC -t 0x1::OnChainConfigDao::OnChainConfigUpdate&lt;0x1::ConsensusConfig::ConsensusConfig&gt; --arg 0x3ce9c3beeb95b555f5e3f2ac297afbf1 <span style=color:#ae81ff>1</span>
</code></pre></div><p>检查提案状态，待执行公示期过后：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e>#必须由提案提交者发起交易执行提案。</span>
account execute-function -s 0x3ce9c3beeb95b555f5e3f2ac297afbf1 --function 0x1::OnChainConfigScripts::execute_on_chain_config_proposal -t 0x1::ConsensusConfig::ConsensusConfig --arg <span style=color:#ae81ff>1</span>
</code></pre></div><p>4.取回质押的 Token</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>account execute-function -s 0x1ddb8ec4850de3a57dede0f82edc5ec3 --function 0x1::DaoVoteScripts::unstake_vote -t 0x1::STC::STC -t 0x1::OnChainConfigDao::OnChainConfigUpdate&lt;0x1::ConsensusConfig::ConsensusConfig&gt; --arg 0x3ce9c3beeb95b555f5e3f2ac297afbf1 --arg <span style=color:#ae81ff>1</span>
</code></pre></div><p>5.最后清理掉完成的提案，验证参数是否正确</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>account execute-function -s 0x3ce9c3beeb95b555f5e3f2ac297afbf1 --function 0x1::Dao::destroy_terminated_proposal -t 0x1::STC::STC -t 0x1::OnChainConfigDao::OnChainConfigUpdate&lt;0x1::ConsensusConfig::ConsensusConfig&gt; --arg 0x3ce9c3beeb95b555f5e3f2ac297afbf1 <span style=color:#ae81ff>1</span>
</code></pre></div></article></div></div></div></div><div class="footer visible-lg"><div class=container><div class="row hr"><div class="col-md-4 item">联系我们</div><div class="col-md-4 item">技术</div><div class="col-md-4 item">社区</div></div><div class="row td"><div class="col-md-4 item">微信公众号: Starcoin区块链</div><div class="col-md-4 item"><a target=_blank href="https://chrome.google.com/webstore/detail/starmask/mfhbebgoclkghebffdldpobeajmbecfk?hl=zh-CN">StarMask
Wallet</a></div><div class="col-md-4 item"><a target=_blank href=https://news.starcoin.org>News 新闻</a></div></div><div class="row td"><div class="col-md-4 item">Twitter: <a target=_blank href=https://twitter.com/starcoinstc>StarcoinSTC</a></div><div class="col-md-4 item"><a target=_blank href=https://explorer.starcoin.org>区块浏览器</a></div><div class="col-md-4 item"><a target=_blank href=https://westar.io>Westar 实验室</a></div></div><div class="row td"><div class="col-md-4 item">加入微信群请加：starcoinorg</div><div class="col-md-4 item"><a target=_blank href=https://developer.starcoin.org>开发者文档</a></div><div class="col-md-4 item"><a target=_blank href=https://www.movelang.io>Move 中文社区</a></div></div><div class="row td"><div class="col-md-4 item">Discord：<a target=_blank href=https://discord.gg/96tKt5exaE>Starcoin Spaceship</a></div><div class="col-md-4 item"><a target=_blank href=https://developer.starcoin.org/zh/sdk/>SDK</a></div><div class="col-md-4 item"><a target=_blank href=https://github.com/starcoinorg/starcoin/discussions>GitHub 讨论区</a></div></div><div class=foot><div class=logo><img src=/img/logo.png></div><div class=copyright>© 2018-2021 Starcoin.org All rights reserved.</div></div></div></div><div class="m-footer visible-xs visible-sm visible-md"><div class=container><div class=go-contact-us>联系我们<img src=/img/r-arrow.png></div><div class=row-li><div class=item>微信公众号: Starcoin区块链</div><div class=item>微信群: starcoinorg</div></div><div class=row-li><div class=item>Twitter: <a target=_blank href=https://twitter.com/starcoinstc>StarcoinSTC</a></div><div class=item>Discord：<a target=_blank href=https://discord.gg/96tKt5exaE>Starcoin Spaceship</a></div></div><div class=go-contact-us>技术<img src=/img/r-arrow.png></div><div class=row-li><div class=item><a target=_blank href="https://chrome.google.com/webstore/detail/starmask/mfhbebgoclkghebffdldpobeajmbecfk?hl=zh-CN">StarMask
Wallet</a></div><div class=item><a target=_blank href=https://explorer.starcoin.org>区块浏览器</a></div></div><div class=row-li><div class=item><a target=_blank href=https://developer.starcoin.org>开发者文档</a></div><div class=item><a target=_blank href=https://developer.starcoin.org/zh/sdk/>SDK</a></div></div><div class=go-contact-us>社区<img src=/img/r-arrow.png></div><div class=row-li><div class=item><a target=_blank href=https://news.starcoin.org>News 新闻</a></div><div class=item><a target=_blank href=https://westar.io>Westar 实验室</a></div></div><div class=row-li><div class=item><a target=_blank href=https://www.movelang.io>Move 中文社区</a></div><div class=item><a target=_blank href=https://github.com/starcoinorg/starcoin/discussions>GitHub 讨论区</a></div></div><div class=copyright><div class=f-logo><img src=/img/logo.png></div></div><div class=crt>© 2018-2021 Starcoin.org All rights reserved.</div></div></div></body></html>